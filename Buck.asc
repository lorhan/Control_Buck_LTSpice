Version 4.1
SHEET 1 2320 680
WIRE 1024 -64 960 -64
WIRE 1360 -64 1296 -64
WIRE 1408 -64 1360 -64
WIRE 960 -16 960 -64
WIRE 1296 16 1296 -64
WIRE 1968 32 1936 32
WIRE 2016 32 1968 32
WIRE 960 80 960 64
WIRE 1936 80 1936 32
WIRE 1888 96 1840 96
WIRE -96 112 -208 112
WIRE 80 112 -16 112
WIRE 144 112 80 112
WIRE 256 112 224 112
WIRE 384 112 256 112
WIRE 1296 144 1296 96
WIRE -208 160 -208 112
WIRE 1888 160 1888 144
WIRE 1936 160 1888 160
WIRE 80 176 80 112
WIRE 256 176 256 112
WIRE 384 176 384 112
WIRE -80 208 -80 160
WIRE 1888 208 1888 160
WIRE -32 224 -32 160
WIRE 944 256 752 256
WIRE -208 288 -208 240
WIRE 80 288 80 240
WIRE 256 288 256 240
WIRE 384 288 384 256
WIRE 944 288 944 256
WIRE 1232 304 1168 304
WIRE 1280 304 1232 304
WIRE 1600 304 1520 304
WIRE 1616 304 1600 304
WIRE 1520 368 1520 304
WIRE 752 384 752 256
WIRE 1168 384 1168 304
WIRE 944 400 944 368
WIRE 1008 400 944 400
WIRE 1024 400 1008 400
WIRE 944 432 944 400
WIRE 752 496 752 464
WIRE 1520 496 1520 448
WIRE 944 512 944 496
WIRE 1168 512 1168 464
FLAG 80 288 0
FLAG 256 288 0
FLAG 384 288 0
FLAG -208 288 0
FLAG 384 112 Uout
FLAG -80 208 0
FLAG -32 224 Upwm
FLAG 960 80 0
FLAG 1024 -64 Utri
FLAG 1296 144 0
FLAG 1360 -64 Upwm
FLAG 1168 512 0
FLAG 1232 304 Uerr
FLAG 1520 496 0
FLAG 1600 304 Uctl
FLAG 1888 208 0
FLAG 1968 32 Uctl2
FLAG 1840 96 Uerr
FLAG 752 496 0
FLAG 944 512 0
FLAG 1008 400 Uref_post
SYMBOL ind 128 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value {Lcrit*0.1}
SYMBOL cap 240 176 R0
SYMATTR InstName C1
SYMATTR Value 3.3µ
SYMBOL res 368 160 R0
SYMATTR InstName R1
SYMATTR Value {Rload}
SYMBOL voltage -208 144 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value {Uin}
SYMBOL diode 96 240 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMBOL sw -112 112 R270
SYMATTR InstName S1
SYMATTR Value ""
SYMATTR SpiceModel SW01
SYMBOL voltage 960 -32 R0
WINDOW 3 -293 146 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 5 0 {Tsw*0.5} {Tsw*0.5} 0 {Tsw} 1e9)
SYMATTR InstName V3
SYMBOL bv 1296 0 R0
SYMATTR InstName B1
SYMATTR Value V={if(V(Uctl2)>V(Utri),5,0)}
SYMBOL bv 1168 368 R0
SYMATTR InstName B2
SYMATTR Value V=V(Uref_post) - V(Uout)
SYMBOL bv 1520 352 R0
SYMATTR InstName B3
SYMATTR Value V=Kp*V(Uerr) + Ki*idt(V(Uerr))
SYMBOL e 1936 64 R0
SYMATTR InstName E1
SYMATTR Value Laplace = {Kp+Ki/(s+1e3)}
SYMBOL cap 928 432 R0
SYMATTR InstName C2
SYMATTR Value 3.3n
SYMBOL res 928 272 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL voltage 752 368 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value {Uref}
TEXT 160 -72 Left 2 !.param fsw = 50k
TEXT 160 -24 Left 2 !.param D = 0.5
TEXT 160 -48 Left 2 !.param Tsw = 1/fsw
TEXT -8 480 Left 2 !.tran 5ms startup
TEXT 56 -160 Left 2 !.Model SW01 SW(Ron=1m Roff=100Meg Vt=0.5)
TEXT 160 24 Left 2 !.param Lcrit = (1-D)*Rload/(2*fsw)
TEXT 160 0 Left 2 !.param Rload = 200
TEXT 576 -80 Left 2 !.param Uin = 20
TEXT 576 -48 Left 2 !.param Uref = 10
TEXT 1616 224 Left 2 !.param Kp = 1
TEXT 1616 256 Left 2 !.param Ki = 1
TEXT -304 -24 Left 2 !.options logparams
